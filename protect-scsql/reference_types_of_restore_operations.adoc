---
permalink: protect-scsql/reference_types_of_restore_operations.html 
sidebar: sidebar 
keywords: SnapCenter Plug-in for SQL Server 
summary: 您可以使用SnapCenter 支援功能、在SQL Server資源上執行不同類型的還原作業。 
---
= 還原作業類型
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
您可以使用SnapCenter 支援功能、在SQL Server資源上執行不同類型的還原作業。

* 還原至最新狀態
* 還原到先前的時間點


在下列情況下、您可以還原至分鐘或還原至先前的時間點：

* 從SnapMirror或SnapVault 不二級儲存設備還原
* 還原至替代路徑（位置）



NOTE: 不支援Volume型的功能。SnapCenter SnapRestore



== 直到現在恢復

在最新的還原作業中（預設為選取）、資料庫會恢復到故障點。執行下列順序、即可達成此目的：SnapCenter

. 在還原資料庫之前、先備份上一個作用中的交易記錄。
. 從您選取的完整資料庫備份還原資料庫。
. 套用所有未提交至資料庫的交易記錄（包括從備份建立到最新時間的備份所產生的交易記錄）。
+
交易記錄會提前移動並套用至任何選取的資料庫。



最新的還原作業需要一組連續的交易記錄。

由於無法從記錄傳送的備份檔案還原SQL Server資料庫交易記錄（記錄傳送功能可讓您自動將交易記錄備份從主要伺服器SnapCenter 執行個體上的主要資料庫傳送至個別次要伺服器執行個體上的一或多個次要資料庫）、 您無法從交易記錄備份執行最新的還原作業。因此、您應該使用SnapCenter 此功能來備份SQL Server資料庫交易記錄檔。

如果您不需要保留所有備份的最新還原功能、可以透過備份原則來設定系統的交易記錄備份保留。



== 最新還原作業的範例

假設您每天中午執行SQL Server備份、星期三下午4點執行您需要從備份還原。由於某種原因、星期三中午的備份驗證失敗、因此您決定從星期二中午的備份還原。之後、如果備份已還原、則所有交易記錄都會向前移動並套用至還原的資料庫、從您建立星期二備份時未提交的記錄開始、並繼續執行星期三下午4點寫入的最新交易記錄（如果已備份交易記錄）。



== 還原到先前的時間點

在時間點還原作業中、資料庫只會還原到過去的特定時間。在下列還原情況下、會執行時間點還原作業：

* 資料庫會在備份交易記錄中還原至指定時間。
* 資料庫隨即還原、只會套用備份交易記錄的子集。



NOTE: 將資料庫還原至某個時間點、會產生新的還原路徑。

下圖說明執行時間點還原作業時發生的問題：

image::../media/point_in_time_recovery_path.gif[還原至先前的時間點]

在映像中、還原路徑1包含完整備份、接著是數個交易記錄備份。您可以將資料庫還原至某個時間點。新的交易記錄備份會在時間點還原作業之後建立、進而產生還原路徑2。建立新的交易記錄備份時、不會建立新的完整備份。由於資料毀損或其他問題、您無法還原目前的資料庫、直到建立新的完整備份為止。此外、也無法將在恢復路徑2中建立的交易記錄套用至屬於恢復路徑1的完整備份。

如果您套用交易記錄備份、也可以指定特定日期和時間、以便停止應用備份交易。為達成此目的、您必須在可用範圍內指定日期和時間、SnapCenter 且此功能會移除任何在該時間點之前未提交的交易。您可以使用此方法將資料庫還原至發生毀損之前的某個時間點、或是從意外的資料庫或表格刪除中還原。



== 時間點還原作業的範例

假設您在午夜進行一次完整資料庫備份、每小時進行一次交易記錄備份。資料庫在上午9：45當機、但您仍要備份故障資料庫的交易記錄。您可以從下列時間點還原案例中進行選擇：

* 還原在午夜所做的完整資料庫備份、並接受資料庫變更之後的遺失。（選項：無）
* 還原完整資料庫備份、並將所有交易記錄備份套用至上午9：45（選項：記錄直到）
* 還原完整的資料庫備份並套用交易記錄備份、指定您希望交易從最後一組交易記錄備份還原的時間。（選項：依特定時間）


在這種情況下、您可以計算報告某個錯誤的日期和時間。在指定日期和時間之前未提交的任何交易都會移除。
